<!DOCTYPE html>
<html>
	<head>
		<style>
		</style>
	</head>
	<body>
		<canvas width="200" height="280" id="paint_area">
			<img id="treble" src="http://library.thinkquest.org/10764/ThinkQuest/cave1/images/treble.gif" />
			<img id="bass" src="http://www.clipart.clipartist.net/clipartist.net/openclipart/art/bass_clef_xxl.png" />
		</canvas><br />
		<button onclick="flashCards.refresh();" value="refresh">refresh</button>
		<script>
			window.flashCards = {
				canvas:{
					dom:null,
					color:'#EEEEEE',
					height:500,
					width:500				
				},
				staff:{
					shortLines:{
						startX:120,
						stopX:180,
						number: 2
					},
					lines:{
						startX:0,
						stopX:375
					},
					startY:25.5,
					stopY:250,
					spacing:25,
					color:"#333"
				},
				
				init: function(){
					flashCards.canvas.dom = document.getElementById('paint_area').getContext('2d');
					flashCards.refresh();
				},
				resetCanvas: function(){
					var cvs, props, staff, shortLines, lines;
					props = flashCards.canvas;
					cvs = props.dom;
					staff = flashCards.staff;
					shortLines = staff.shortLines;
					lines = staff.lines;
					
					//create and fill the rectangle
					cvs.fillStyle = props.color;
					cvs.fillRect(0,0,props.height,props.width);
					
					cvs.beginPath();
					//make the staff lines
					for (var y = staff.startY, l = 1; y < staff.stopY; y += staff.spacing, l++) {
						//account for outer lines
						if(l <= shortLines.number || l > (shortLines.number + 5)){
							//we only want these lines to be long enough to hold the note. They shouldn't stretch across the whole screen
							cvs.moveTo(shortLines.startX, y);
							cvs.lineTo(shortLines.stopX, y);
						}else{
							cvs.moveTo(lines.startX, y);
							cvs.lineTo(lines.stopX, y);
						}
					}
					cvs.strokeStyle = staff.color;
					cvs.stroke();
					cvs.closePath();
					
					return cvs;					
				},
				notes:{
					"x":150,
					"spacing":12.5,
					"radius":15,
					"sA":0,/*idk what sA stands for...*/
					"eA":Math.PI * 2,/*idk what eA stands for...*/
					"acw":false,/*idk what acw stands for...*/
					list:[
						{"steps":1,"treble":"D", "bass":"F"},
						{"steps":2,"treble":"C", "bass":"E"},
						{"steps":3,"treble":"B", "bass":"D"},
						{"steps":4,"treble":"A", "bass":"C"},
						{"steps":5,"treble":"G", "bass":"B"},
						{"steps":6,"treble":"F", "bass":"A"},
						{"steps":7,"treble":"E", "bass":"G"},
						{"steps":8,"treble":"D", "bass":"F"},
						{"steps":9,"treble":"C", "bass":"E"},
						{"steps":10,"treble":"B", "bass":"D"},
						{"steps":11,"treble":"A", "bass":"C"},
						{"steps":12,"treble":"G", "bass":"B"},
						{"steps":13,"treble":"F", "bass":"A"},
						{"steps":14,"treble":"E", "bass":"G"},
						{"steps":15,"treble":"D", "bass":"F"},
						{"steps":16,"treble":"C", "bass":"E"},
						{"steps":17,"treble":"B", "bass":"D"},
						{"steps":18,"treble":"A", "bass":"C"},
						{"steps":19,"treble":"G", "bass":"B"}
					]
				},
				/*redraw the notes. This needs a lot of clean up and abstraction still*/
				refreshNotes: function(){
					var ctx, notes;
					ctx = flashCards.canvas.dom;
					notes = flashCards.notes;
					
					//start a new path to make the notes with
					ctx.beginPath();
	
					//draw a random note
					var note = notes.list[(Math.floor(Math.random() * notes.list.length))];
					ctx.arc(notes.x, (notes.spacing * note.steps), notes.radius, notes.sA, notes.eA, notes.acw);
					ctx.closePath();
					ctx.strokeStyle = "#000";
					ctx.stroke();
					ctx.fillStyle = "#000";
					ctx.fill();
	
					//generate the clefs
					var clefs = [
						{"name": "treble","x": 10,"y": 50,"width": 50,"height": 175},
						{"name": "bass","x": 10,"y": 75,"width": 60,"height": 87}
					]
	
					//draw one random clef
					clef = clefs[(Math.floor(Math.random() * clefs.length))];
					var clefDOM = document.getElementById(clef.name);
					ctx.drawImage(clefDOM, clef.x, clef.y, clef.width, clef.height);
	
					ctx.canvas.addEventListener('mousedown', function() {
						//Draw the note letter associated with randomly chosen note
						ctx.fillStyle = '#EEEEEE';
						ctx.fillRect(5,245,35,35);
						ctx.font = "bold 30px sans-serif";
						ctx.fillStyle = '#000000';
						ctx.fillText(note[clef.name], 10, 275);
					}, false);
					ctx.canvas.addEventListener('mouseup', function() {
	
					}, false);					
				},
				refresh:function(){
					flashCards.resetCanvas();
					flashCards.refreshNotes();
				}
			};
			
			flashCards.init();
		</script>

	<!-- http://diveintohtml5.org/canvas.html#divingin -->
	<!-- http://playground.html5rocks.com/#canvas_tag -->
	</body>
</html>